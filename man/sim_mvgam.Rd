% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sim_mvgam.R
\name{sim_mvgam}
\alias{sim_mvgam}
\title{Simulate a set of discrete time series for mvgam modelling}
\usage{
sim_mvgam(
  T = 100,
  n_series = 3,
  seasonality = "shared",
  use_lv = FALSE,
  n_lv = 2,
  trend_model = "RW",
  drift = FALSE,
  trend_rel = 0.2,
  freq = 12,
  family = "poisson",
  phi_obs,
  mu_obs = 4,
  prop_missing = 0,
  train_prop = 0.85
)
}
\arguments{
\item{T}{\code{integer}. Number of observations (timepoints)}

\item{n_series}{\code{integer}. Number of discrete time series}

\item{seasonality}{\code{character}. Either \code{shared}, meaning that all series share the exact same seasonal pattern,
or \code{hierarchical}, meaning that there is a global seasonality but each series' pattern can deviate slightly}

\item{use_lv}{\code{logical}. If \code{TRUE}, use dynamic factors to estimate series'
latent trends in a reduced dimension format. If \code{FALSE}, estimate independent latent trends for each series}

\item{n_lv}{\code{integer}. Number of latent dynamic factors for generating the series' trends}

\item{trend_model}{\code{character} specifying the time series dynamics for the latent trends. Options are:
'RW' (random walk with possible drift),
'AR1' (AR1 model with intercept),
'AR2' (AR2 model with intercept) or
'AR3' (AR3 model with intercept) or
'GP' (Gaussian process with squared exponential kernel}

\item{drift}{\code{logical}, simulate a drift term for each trend}

\item{trend_rel}{\code{numeric}. Relative importance of the trend for each series. Should be between \code{0} and \code{1}}

\item{freq}{\code{integer}. The seasonal frequency of the series}

\item{family}{\code{character} specifying the exponential observation family for the series. Must be either
'nb' (for Negative Binomial), 'tw' (for Tweedie) or 'poisson'}

\item{phi_obs}{\code{vector} of dispersion parameters for the series (i.e. \code{size} for Negative Binomial or
\code{phi} for Tweedie; ignored for Poisson). If \code{length(phi_obs) < n_series}, the first element of \code{phi_obs} will
be replicated \code{n_series} times}

\item{mu_obs}{\code{vector} of location parameters for the series. If \code{length(mu_obs) < n_series}, the first element of \code{mu_obs} will
be replicated \code{n_series} times}

\item{prop_missing}{\code{numeric} stating proportion of observations that are missing}

\item{train_prop}{\code{numeric} stating the proportion of data to use for training. Should be between \code{0.25} and \code{0.75}}
}
\value{
A \code{list} object containing outputs needed for \code{\link{mvgam}}, including 'data_train' and 'data_test',
as well as some additional information about the simulated seasonality and trend dependencies
}
\description{
This function simulates discrete time series data for fitting a multivariate GAM that includes
shared seasonality and dependence on state-space latent dynamic factors. Random dependencies among series, i.e.
correlations in their long-term trends, are included in the form of correlated loadings on the latent dynamic factors
}
