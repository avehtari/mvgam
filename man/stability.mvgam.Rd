% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stability.R
\name{stability.mvgam}
\alias{stability.mvgam}
\alias{stability}
\title{Calculate measures of latent VAR community stability}
\usage{
stability(object, ...)

\method{stability}{mvgam}(object)
}
\arguments{
\item{object}{\code{list} object of class \code{mvgam} resulting from a call to \code{\link[=mvgam]{mvgam()}}
that used a Vector Autoregressive latent process model (either as \code{VAR(cor = FALSE)} or
\code{VAR(cor = TRUE)})}

\item{...}{ignored}
}
\value{
An \code{data.frame} containing posterior draws for each of the above stability metrics.
}
\description{
Compute reactivity, return rates and contributions of interactions to
stationary forecast variance from
\code{mvgam} models with Vector Autoregressive dynamics
}
\details{
These measures of stability can be used to assess how systems respond to
environmental perturbations. Using the formula for a latent VAR(1) as:
\deqn{
\mu_t \sim \text{MVNormal}(A(\mu_{t - 1}), \Sigma) \quad
}
this function will calculate the long-term stationary forecast distribution of the system, which
has mean \eqn{\mu_{\infty}} and variance \eqn{\Sigma_{\infty}}, to then calculate the following quantities:
\itemize{
\item \code{prop_int}: Proportion of the volume of the stationary forecast distribution
that is attributable to lagged interactions (i.e. how important are the autoregressive
interaction coefficients in \eqn{A} for explaining the shape of the stationary forecast distribution?):
\deqn{
    det(A)^2 \quad
    }
\item \code{prop_int_adj}: Same as \code{prop_int} but scaled by the number of series to facilitate
direct comparisons among systems with different numbers of interacting variables \eqn{p}:
\deqn{
    det(A)^{2/p} \quad
    }
\item \code{prop_int_offdiag}: Sensitivity of \code{prop_int} to intra-series
interactions (i.e. how important are the off-diagonals of the autoregressive coefficient
matrix \eqn{A} for shaping \code{prop_int}?), calculated as the relative magnitude of the \emph{off-diagonals} in
the partial derivative matrix:
\deqn{
    [2~det(A) (A^{-1})^T] \quad
    }
\item \code{prop_int_diag}: Sensitivity of \code{prop_int} to inter-series
interactions (i.e. how important are the diagonals of the autoregressive coefficient matrix \eqn{A}
for shaping \code{prop_int}?), calculated as the relative magnitude of the \emph{diagonals} in the partial derivative
matrix:
\deqn{
    [2~det(A) (A^{-1})^T] \quad
    }
\item \code{prop_cov}: Sensitivity of \eqn{\Sigma_{\infty}} to intra-series error correlations
(i.e. how important are off-diagonal covariances in \eqn{\Sigma} for shaping
\eqn{\Sigma_{\infty}}?), calculated as the relative magnitude of the \emph{off-diagonals} in
the partial derivative matrix:
\deqn{
    [2~det(\Sigma_{\infty}) (\Sigma_{\infty}^{-1})^T] \quad
    }
\item \code{reactivity}: A measure of the degree to which the system moves
away from a stable equilibrium following a perturbation
values \verb{> 0} suggest the system is reactive, whereby a
perturbation of the system in one period can be amplified in the next period. If
\eqn{\sigma_{max}(A)} is the largest singular value of \eqn{A}, then reactivity is defined as:
\deqn{
    log\sigma_{max}(A) \quad
    }
\item \code{mean_return_rate}: Asymptotic (long-term) return rate of the mean of the transition distribution
to the stationary mean, calculated using the largest eigenvalue of the matrix \eqn{A}:
\deqn{
   max(\lambda_{A}) \quad
   }
Lower values suggest greater stability
\item \code{var_return_rate}: Asymptotic (long-term) return rate of the variance of the transition distribution
to the stationary variance:
\deqn{
   max(\lambda_{A \otimes{A}}) \quad
   }
Again, lower values suggest greater stability
}
}
\examples{
\donttest{
# Simulate some time series that follow a latent VAR(1) process
simdat <- sim_mvgam(family = gaussian(),
                    n_series = 4,
                    trend_model = VAR(cor = TRUE),
                    prop_trend = 1)
plot_mvgam_series(data = simdat$data_train, series = 'all')

# Fit a model that uses a latent VAR(1)
mod <- mvgam(y ~ -1,
             trend_formula = ~ 1,
             trend_model = VAR(cor = TRUE),
             family = gaussian(),
             data = simdat$data_train,
             silent = 2)

# Calulate stability metrics for this system
metrics <- stability(mod)

# Proportion of stationary forecast distribution
# attributable to lagged interactions
hist(metrics$prop_int,
  xlim = c(0, 1),
  xlab = 'Prop_int',
  main = '',
  col = '#B97C7C',
  border = 'white')

# Proportion of stationary forecast distribution
# attributable to correlated process errors
hist(metrics$prop_env,
  xlim = c(0, 1),
  xlab = 'Prop_env',
  main = '',
  col = '#B97C7C',
  border = 'white')

# Reactivity, i.e. degree to which the system moves
# away from a stable equilibrium following a perturbation
hist(metrics$reactivity,
  main = '',
  xlab = 'Reactivity',
  col = '#B97C7C',
  border = 'white',
  xlim = c(-1*max(abs(metrics$reactivity)),
          max(abs(metrics$reactivity))))
abline(v = 0, lwd = 2.5)
}
}
\references{
AR Ives, B Dennis, KL Cottingham & SR Carpenter (2003).
Estimating community stability and ecological interactions from time-series data.
Ecological Monographs. 73, 301-330.
}
\seealso{
\code{\link{VAR}}
}
\author{
Nicholas J Clark
}
