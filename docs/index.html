<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Fit Bayesian Dynamic Generalised Additive Models to sets of time series. 
             The primary purpose of the package is to build dynamic nonlinear models that incorporate 
             the flexibility of GAMs in the linear predictor and latent trend components that are useful 
             for time series analysis and forecasting. Estimation is performed using Markov Chain Monte Carlo (MCMC) with
             either the Gibbs sampling software JAGS or with Hamiltonian Monte Carlo in the software Stan. The package also includes 
             utilities for online updating of  forecast distributions with a recursive particle filter that 
             uses sequential importance sampling to assimilate new observations as they become available. 
             References: Clark &amp; Wells (2022) &lt;https://doi.org/10.1111/2041-210X.13974&gt;.">
<title>Multivariate (Dynamic) Generalized Additive Models â€¢ mvgam</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Multivariate (Dynamic) Generalized Additive Models">
<meta property="og:description" content="Fit Bayesian Dynamic Generalised Additive Models to sets of time series. 
             The primary purpose of the package is to build dynamic nonlinear models that incorporate 
             the flexibility of GAMs in the linear predictor and latent trend components that are useful 
             for time series analysis and forecasting. Estimation is performed using Markov Chain Monte Carlo (MCMC) with
             either the Gibbs sampling software JAGS or with Hamiltonian Monte Carlo in the software Stan. The package also includes 
             utilities for online updating of  forecast distributions with a recursive particle filter that 
             uses sequential importance sampling to assimilate new observations as they become available. 
             References: Clark &amp; Wells (2022) &lt;https://doi.org/10.1111/2041-210X.13974&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">mvgam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/data_in_mvgam.html">Formatting data for use in mvgam</a>
    <a class="dropdown-item" href="articles/forecast_evaluation.html">Forecasting and forecast evaluation in mvgam</a>
    <a class="dropdown-item" href="articles/mvgam_overview.html">Overview of the mvgam package</a>
    <a class="dropdown-item" href="articles/shared_states.html">Shared latent states in mvgam</a>
    <a class="dropdown-item" href="articles/time_varying_effects.html">Time-varying effects in mvgam</a>
    <a class="dropdown-item" href="articles/trend_formulas.html">State-Space models in mvgam</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nicholasjclark/mvgam/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><p><br><br></p>
<div class="section level2">
<h2 id="mvgam">mvgam<a class="anchor" aria-label="anchor" href="#mvgam"></a>
</h2>
<p><strong>M</strong>ulti<strong>V</strong>ariate (Dynamic) <strong>G</strong>eneralized <strong>A</strong>ddivite <strong>M</strong>odels</p>
<p>The goal of <code>mvgam</code> is to use a Bayesian framework to estimate parameters of Dynamic Generalized Additive Models (DGAMs) for time series with dynamic trend components. The package provides an interface to fit Bayesian DGAMs using either <code>JAGS</code> or <code>Stan</code> as the backend, but note that users are strongly encouraged to opt for <code>Stan</code> over <code>JAGS</code>. The formula syntax is based on that of the package <code>mgcv</code> to provide a familiar GAM modelling interface. The motivation for the package and some of its primary objectives are described in detail by <a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.13974" class="external-link">Clark &amp; Wells 2022</a> (published in <em>Methods in Ecology and Evolution</em>).</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the development version from <code>GitHub</code> using: <code>devtools::install_github("nicholasjclark/mvgam")</code>. Note that to actually condition models with MCMC sampling, either the <code>JAGS</code> software must be installed (along with the <code>R</code> packages <code>rjags</code> and <code>runjags</code>) or the <code>Stan</code> software must be installed (along with either <code>rstan</code> and/or <code>cmdstanr</code>). Only <code>rstan</code> is listed as a dependency of <code>mvgam</code> to ensure that installation is less difficult. If users wish to fit the models using <code>mvgam</code>, please refer to installation links for <code>JAGS</code> <a href="https://sourceforge.net/projects/mcmc-jags/files/" class="external-link">here</a>, for <code>Stan</code> with <code>rstan</code> <a href="https://mc-stan.org/users/interfaces/rstan" class="external-link">here</a>, or for <code>Stan</code> with <code>cmdstandr</code> <a href="https://mc-stan.org/cmdstanr/" class="external-link">here</a>. You will need a fairly recent version of <code>Stan</code> to ensure all the model syntax is recognized. If you see warnings such as <code>variable "array" does not exist</code>, this is usually a sign that you need to update your version of <code>Stan</code>. We highly recommend you use <code>Cmdstan</code> through the <code>cmdstanr</code> interface as the backend. This is because <code>Cmdstan</code> is easier to install, is more up to date with new features, and uses less memory than <code>Rstan</code>. See <a href="http://mc-stan.org/cmdstanr/articles/cmdstanr.html#comparison-with-rstan" class="external-link">this documentation from the <code>Cmdstan</code> team for more information</a>.</p>
</div>
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p><code>mvgam</code> was originally designed to analyse and forecast non-negative integer-valued data (counts). These data are traditionally challenging to analyse with existing time-series analysis packages. But further development of <code>mvgam</code> has resulted in support for a growing number of observation families that extend to other types of data. Currently, the package can handle data for the following families:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian()</a></code> for real-valued data</li>
<li>
<code><a href="reference/mvgam_families.html">student_t()</a></code> for heavy-tailed real-valued data</li>
<li>
<code>lognormal()</code> for non-negative real-valued data</li>
<li>
<code><a href="https://rdrr.io/r/stats/family.html" class="external-link">Gamma()</a></code> for non-negative real-valued data</li>
<li>
<code>betar()</code> for proportional data on <code>(0,1)</code>
</li>
<li>
<code><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson()</a></code> for count data</li>
<li>
<code>nb()</code> for overdispersed count data</li>
<li>
<code><a href="reference/mvgam_families.html">tweedie()</a></code> for overdispersed count data</li>
</ul>
<p>Note that only <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson()</a></code>, <code>nb()</code>, and <code><a href="reference/mvgam_families.html">tweedie()</a></code> are available if using <code>JAGS</code>. All families, apart from <code><a href="reference/mvgam_families.html">tweedie()</a></code>, are supported if using <code>Stan</code>. See <code>??mvgam_families</code> for more information. Below is a simple example for simulating and modelling proportional data with <code>Beta</code> observations over a set of seasonal series with independent Gaussian Process dynamic trends:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sim_mvgam.html">sim_mvgam</a></span><span class="op">(</span>family <span class="op">=</span> <span class="fu">betar</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 T <span class="op">=</span> <span class="fl">80</span>,</span>
<span>                 trend_model <span class="op">=</span> <span class="st">'GP'</span>,</span>
<span>                 trend_rel <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                 seasonality <span class="op">=</span> <span class="st">'shared'</span><span class="op">)</span></span></code></pre></div>
<p>Plot the series to see how they evolve over time</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot_mvgam_series.html">plot_mvgam_series</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">data_train</span>, series <span class="op">=</span> <span class="st">'all'</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-beta_sim-1.png"></p>
<p>Fit a DGAM to these series that uses a hierarchical cyclic seasonal smooth term to capture variation in seasonality among series. The model also includes series-specific latent Gaussian Processes with squared exponential covariance functions to capture temporal dynamics</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mvgam.html">mvgam</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">season</span>, bs <span class="op">=</span> <span class="st">'cc'</span>, k <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> <span class="op">+</span></span>
<span>               <span class="fu">s</span><span class="op">(</span><span class="va">season</span>, by <span class="op">=</span> <span class="va">series</span>, m <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>             trend_model <span class="op">=</span> <span class="st">'GP'</span>,</span>
<span>             data <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">data_train</span>,</span>
<span>             newdata <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">data_test</span>,</span>
<span>             family <span class="op">=</span> <span class="fu">betar</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Plot the estimated posterior hindcast and forecast distributions for each series</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">'forecast'</span>, series <span class="op">=</span> <span class="va">i</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="reference/figures/README-beta_fc-1.png"></p>
<p>Various <code>S3</code> functions can be used to inspect parameter estimates, plot smooth functions and residuals, and evaluate models through posterior predictive checks or forecast comparisons. Please see the package documentation for more detailed examples.</p>
</div>
<div class="section level2">
<h2 id="vignettes">Vignettes<a class="anchor" aria-label="anchor" href="#vignettes"></a>
</h2>
<p>You can set <code>build_vignettes = TRUE</code> when installing with either <code><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">devtools::install_github</a></code> or <code><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">remotes::install_github</a></code>, but be aware this will slow down the installation drastically. Instead, you can always access the vignette htmls online at <a href="https://nicholasjclark.github.io/mvgam/articles/" class="uri">https://nicholasjclark.github.io/mvgam/articles/</a></p>
</div>
<div class="section level2">
<h2 id="other-resources">Other resources<a class="anchor" aria-label="anchor" href="#other-resources"></a>
</h2>
<p>A number of case studies have been compiled to highlight how DGAMs can be estimated using MCMC sampling. These are hosted currently on <code>RPubs</code> at the following links:</p>
<ul>
<li><a href="https://rpubs.com/NickClark47/mvgam" class="external-link">mvgam case study 1: model comparison and data assimilation</a></li>
<li><a href="https://rpubs.com/NickClark47/mvgam2" class="external-link">mvgam case study 2: multivariate models</a></li>
<li><a href="https://rpubs.com/NickClark47/mvgam3" class="external-link">mvgam case study 3: distributed lag models</a></li>
</ul>
<p>The package can also be used to generate all necessary data structures, initial value functions and modelling code necessary to fit DGAMs using <code>Stan</code> or <code>JAGS</code>. This can be helpful if users wish to make changes to the model to better suit their own bespoke research / analysis goals. The following resources can be helpful to troubleshoot:</p>
<ul>
<li><a href="https://discourse.mc-stan.org/" class="external-link">Stan Discourse</a></li>
<li><a href="https://sourceforge.net/projects/mcmc-jags/" class="external-link">JAGS Discourse</a></li>
</ul>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/nicholasjclark/mvgam/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing mvgam</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://researchers.uq.edu.au/researcher/15140" class="external-link">Nicholas J Clark</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-7131-3301" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://researchers.uq.edu.au/researcher/15140" class="external-link">Nicholas J Clark</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
