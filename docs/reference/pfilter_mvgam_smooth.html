<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function operates on a new observation in next_assim to update the
posterior forecast distribution. The next observation is assimilated
and particle weights are updated in light of their most recent their multivariate composite likelihood.
Low weight particles are smoothed towards the high weight state space using importance sampling, and options are
given for using resampling of high weight particles when Effective Sample Size falls below a
user-specified threshold"><title>Assimilate new observations into a fitted mvgam model using resampling and kernel smoothing — pfilter_mvgam_smooth • mvgam</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Assimilate new observations into a fitted mvgam model using resampling and kernel smoothing — pfilter_mvgam_smooth"><meta property="og:description" content="This function operates on a new observation in next_assim to update the
posterior forecast distribution. The next observation is assimilated
and particle weights are updated in light of their most recent their multivariate composite likelihood.
Low weight particles are smoothed towards the high weight state space using importance sampling, and options are
given for using resampling of high weight particles when Effective Sample Size falls below a
user-specified threshold"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mvgam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data_in_mvgam.html">Formatting data for use in mvgam</a>
    <a class="dropdown-item" href="../articles/forecast_evaluation.html">Forecasting and forecast evaluation in mvgam</a>
    <a class="dropdown-item" href="../articles/mvgam_overview.html">Overview of the mvgam package</a>
    <a class="dropdown-item" href="../articles/shared_states.html">Shared latent states in mvgam</a>
    <a class="dropdown-item" href="../articles/time_varying_effects.html">Time-varying effects in mvgam</a>
    <a class="dropdown-item" href="../articles/trend_formulas.html">State-Space models in mvgam</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nicholasjclark/mvgam/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Assimilate new observations into a fitted mvgam model using resampling and kernel smoothing</h1>
      <small class="dont-index">Source: <a href="https://github.com/nicholasjclark/mvgam/blob/HEAD/R/pfilter_mvgam_smooth.R" class="external-link"><code>R/pfilter_mvgam_smooth.R</code></a></small>
      <div class="d-none name"><code>pfilter_mvgam_smooth.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function operates on a new observation in <code>next_assim</code> to update the
posterior forecast distribution. The next observation is assimilated
and particle weights are updated in light of their most recent their multivariate composite likelihood.
Low weight particles are smoothed towards the high weight state space using importance sampling, and options are
given for using resampling of high weight particles when Effective Sample Size falls below a
user-specified threshold</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pfilter_mvgam_smooth</span><span class="op">(</span></span>
<span>  <span class="va">particles</span>,</span>
<span>  <span class="va">mgcv_model</span>,</span>
<span>  <span class="va">next_assim</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  use_resampling <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  kernel_lambda <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>particles</dt>
<dd><p>A <code>list</code> of particles that have been run up to one observation prior to the observation
in <code>next_assim</code></p></dd>


<dt>mgcv_model</dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code> model returned through a call to <code>link{mvgam}</code></p></dd>


<dt>next_assim</dt>
<dd><p>A <code>dataframe</code> of test data containing at one more observation per series
(beyond the last observation seen by the model when initialising particles with
<code><a href="pfilter_mvgam_init.html">pfilter_mvgam_init</a></code> or in previous calls to <code>pfilter_mvgam_online</code>.
Should at least contain 'series' and 'time' for the one-step ahead horizon,
in addition to any other variables included in the linear predictor of <code>object</code></p></dd>


<dt>threshold</dt>
<dd><p><code>proportional numeric</code> specifying the Effective Sample Size limit under which
resampling of particles will be triggered (calculated as <code>ESS / n_particles</code>) if <code>use_resampling == TRUE</code>.
Should be between <code>0</code> and <code>1</code></p></dd>


<dt>n_cores</dt>
<dd><p><code>integer</code> specifying number of cores for generating particle forecasts in parallel</p></dd>


<dt>use_resampling</dt>
<dd><p><code>logical</code> specifying whether resampling should be used when ESS falls below
the specified <code>threshold</code>. Note that resampling can result in loss of the original model's diversity of
GAM beta coefficients, which may have undesirable consequences for the forecast distribution. If
<code>use_resampling</code> is <code>TRUE</code>, some effort is made to remedy this by assigning randomly sampled draws of
GAM beta coefficients from the original model's distribution to each particle. This does not however guarantee there
will be no loss of diversity, especially if successive resampling take place. Default for this option is therefore
<code>FALSE</code></p></dd>


<dt>kernel_lambda</dt>
<dd><p><code>proportional numeric</code> specifying the strength of smoothing to use when
pulling low weight particles toward the high likelihood state space. Should be between <code>0</code> and <code>1</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A <code>list</code> object of <code>length = n_particles</code> containing information on parameters and
current state estimates for each particle</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://researchers.uq.edu.au/researcher/15140" class="external-link">Nicholas J Clark</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

